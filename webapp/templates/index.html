<!doctype html>
<html ng-app="cs194proj" ng-controller="MainController">
    <head>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script src="static/jquery-ui-1.12.1.custom/jquery-ui.min.js"></script>
        <script type="text/javascript" src="static/angular.js"></script>
        <script src="static/bower_components/angular-dragdrop/src/angular-dragdrop.min.js"></script>

       <link href="https://fonts.googleapis.com/css?family=Quicksand:300,400,500,700" rel="stylesheet">
        
        <!--Include the main controller (MainController) and stylesheet -->
        <script type="text/javascript" src="static/mainController.js"></script>
        <link rel="stylesheet" type="text/css" href="static/main.css" />
        <!-- add bootstrap -->

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    </head>

    {% raw %}
    <!-- Because Angular and Flask both use "{{}}" to delimit special varibales, -->
    <!-- we've changed the default Angular delimiter from "{{}}" to "[[]]" -->
    {% endraw %}
    
    <body class = "main">

        <div class = "titleBar row"> 
            <div class = "col-md-3 element"> Arsenic Webdriver </div>
            <div class = "col-md-5 space"></div> 
	    {% if current_user.is_authenticated %}
            <div class = "col-md-2 element">Hi {{ current_user.username }}!</div>
	    <form action="/logout" method="get">
		<div class="col-md-1">
		    <input type="submit" value="logout"></input>
		</div>
	    </form>
	    {% else %}
            <div class = "verticalCenter">
                <form action="/login" method="post"> 
                        <div class = "col-md-1"> 
                            <input type="text" name ="username">
                        </div>
                        <div class = "col-md-1"> 
                            <input type="text" name ="password">
                        </div>
                        <div class = "col-md-1"> 
                            <input type="submit" value="login">
                        </div>
                    </div>
                </form>
            </div>
	    {% endif %}
        </div>

        <div class = "createPrompt"> Create a script! </div>

        <div class = "row prompt"> 
            <div class = "col-md-2"></div>
            <div class = "col-md-2 center2"> What browsers would you like to test on? </div>

            <div class = "col-md-2" ng-click = "firefoxSelected = !firefoxSelected">
                <div ng-class = "{browser: firefoxSelected, browser2: !firefoxSelected}"> Firefox </div> 
            </div>
            <div class = "col-md-2" ng-click = "chromeSelected = !chromeSelected"> 
                <div ng-class = "{browser: chromeSelected, browser2: !chromeSelected}"> Chrome </div> 
            </div>
            <div class = "col-md-2 " ng-click = "safariSelected = !safariSelected"> 
                <div ng-class = " {browser: safariSelected, browser2: !safariSelected}"> Safari </div> 
            </div>
        </div>

        <!-- need to set listItem.action = "navigate to url" -->
        <div ng-if = "selectorList.length == 0" class = "form-group row prompt"> 
            <div class = "col-md-2"></div>
            <div class = "col-md-4 center"> What website would you like to test? </div>
            <div class = "col-md-2 center"> <input placeholder = "enter URL" class = "input form-control" type="text" ng-model="listItem.url"/></div>
            <div class = "col-md-2"> <div class = "addButton" ng-click="listItem.action = 'navigate to url'; add(listItem)">Add</div> </div>
        </div>
 
        <div ng-repeat="item in selectorList" data-drop="true" data-drag="true" ng-model="selectorList" jqyoui-droppable="{index: [[$index]], onDrop:'dropCallback',}" jqyoui-draggable="{index: [[$index]], insertInline: true, direction:'jqyouiDirection',animate: true, onStart: 'startCallback'}" data-jqyoui-options="{revert: 'invalid'}" data-direction="[[item.jqyouiDirection]]">
            <div class = "row">
                <div class = "col-md-2"></div>
                <div class = "addedRow col-md-8">
                    <div class = "col-md-3 action"> [[item.action]] </div>
                    <div class = "col-md-3 secondary" ng-show = "item.selector != ''"> 
                        <div class = "label1"> Selector: </div>
                        <div class = "customized"> [[item.selector]] </div>
                    </div>
                    <div class = "col-md-3 secondary" ng-show = "item.url != ''"> 
                        <div class = "label1"> URL: </div>
                        <div class = "customized"> [[item.url]] </div>
                    </div>
                    <div class = "col-md-3 secondary" ng-show = "item.text != ''"> 
                        <div class = "label1"> Text: </div>
                        <div class = "customized"> [[item.text]] </div>
                    </div>
                </div>
                <div class = "col-md-1 remove" ng-click = "remove($index)"> Remove </div>
                <div class = "col-md-2"></div> 
            </div>
        </div>

        <div class = "row" ng-show="show">
            <div class = "col-md-2"></div>

            <div class = "col-md-2">
            <select name="actions" class = "input selectpicker width" ng-model = "listItem.action" ng-change = "selectedChanged()">
              <option value="navigate to url">navigate to</option>
              <option value="exists">check if exists</option>
              <option value="does not exist">check if doesn't exist</option>
              <option value="click">click on</option>
              <option value="enter text">enter text in box</option>
            </select>
            </div>

            <!-- EDIT HERE!! -->
            <div ng-show = "listItem.action != 'navigate to url' && listItem.action != 'enter text' ">
                <div class = "col-md-4 center"> 
                    <input class = "input form-control" type="text" placeholder = "enter selector" ng-model="listItem.selector" /> 
                </div> 
            </div>
            <div ng-show = "listItem.action == 'enter text' ">
                <div class = "col-md-2 center"> 
                    <input class = "input form-control" type="text" placeholder = "enter selector" ng-model="listItem.selector" />
                </div> 
                <div class = "col-md-2 center"> 
                    <input class = "input form-control" type="text" placeholder = "enter text" ng-model="listItem.text" />
                </div>
            </div>
            <div ng-show = "listItem.action == 'navigate to url'">
                <div class = "col-md-4 center"> 
                    <input class = "input form-control" type="text" placeholder = "enter url" ng-model="listItem.url" />
                </div>
            </div>
            <div class = "col-md-2"> <div class = "addButton" ng-click="add(listItem)">Add</div> </div>
            <div class = "col-md-2"></div> 
        </div>

        <div class = "row">
            <div class = "col-md-2"></div>
            <div ng-show = "warningMessage != ''" class = "col-md-6"> <div class = "warningMessage center"> [[warningMessage]] </div> </div>
            <div ng-show = "warningMessage != ''" class = "col-md-2" ng-click = "dismiss()"> <div class = "dismiss"> dismiss </div> </div>
        </div>

        <div ng-show = "showSavedRows">
            <div class = "availableSnippets"> snippets available to add </div> 

            <div ng-repeat = "item in savedRowsArray" data-drop="true" data-drag="true" ng-model="savedRowsArray" jqyoui-droppable="{index: [[$index]]}" jqyoui-draggable="{index: [[$index]], insertInline: true, direction:'jqyouiDirection',animate: true}" data-jqyoui-options="{revert: 'invalid'}" data-direction="[[item.jqyouiDirection]]">
                <div class = "row">
                    <div class = "col-md-2"></div>    
                    <div class = "col-md-6 subsetTitle"> [[item.name]] </div>
                    <div class = "col-md-2 add" ng-click = "addSnippetToTest(item.name)"> add </div>
                    <div class = "col-md-1 remove" ng-click = "removeSnippet($index)"> Remove </div>   
                </div>
                <div ng-repeat = "jsonObject in item.values"> 
                    <div class = "row">
                        <div class = "col-md-2"></div>
                        <div class = "addedRow col-md-8">
                            <div class = "col-md-3"> [[jsonObject.action]] </div>
                            <div class = "col-md-3" ng-show = "jsonObject.selector != ''"> 
                                <div class = "label1"> Selector: </div>
                                <div class = "customized"> [[jsonObject.selector]] </div>
                            </div>
                            <div class = "col-md-3" ng-show = "jsonObject.url != ''"> 
                                <div class = "label1"> URL: </div>
                                <div class = "customized"> [[jsonObject.url]] </div>
                            </div>
                            <div class = "col-md-3" ng-show = "jsonObject.text != ''"> 
                                <div class = "label1"> Text: </div>
                                <div class = "customized"> [[jsonObject.text]] </div>
                            </div>
                        </div>
                    </div>
                </div>  
            </div>

            <div class = "row">
                <div class = "col-md-2"></div>  
                <div class = "col-md-8 addSnippetButton" ng-click = "addSnippetViewable = !addSnippetViewable"> add another snippet to your list </div>  
            </div>

            <!-- SNIPPET STUFF HERE -->
            <div ng-if="addSnippetViewable == true" class = "adding">
                <div class = "row color" ng-if = "snippetNamed == false">
                    <div class = "col-md-2"></div>
                    <div class = "col-md-4 addSnippetDialogue">
                        What do you want to call this snippet? 
                    </div>
                    <div class = "col-md-2 center"> 
                        <input class = "input form-control" type = "text"  ng-model="model.currentSnippetName"/> 
                    </div>
                    <div class = "col-md-2"> <div class = "nameSnippet" ng-click = "nameSnippet()"> submit </div> </div> 
                </div> 

                <div ng-if= "snippetNamed == true">
                    <div class = "row snippetTitle">
                        <div class = "col-md-2"></div>
                        <div class = "col-md-8"> Snippet name: [[tempSnippet.name]] </div>
                    </div>

                    <!-- THIS DISPLAYS THE CURRENT SNIPPET IN PROGRESS -->
                    <div ng-repeat="snippet in snippetInProgress" data-drop="true" data-drag="true" ng-model="snippetInProgress" jqyoui-droppable="{index: [[$index]],}" jqyoui-draggable="{index: [[$index]], insertInline: true, direction:'jqyouiDirection',animate: true}" data-jqyoui-options="{revert: 'invalid'}" data-direction="[[item.jqyouiDirection]]">
                                <div class = "row">
                                    <div class = "col-md-2"></div>
                                    <div class = "addedRow col-md-8">
                                        <div class = "col-md-3 action"> [[snippet.action]] </div>
                                        <div class = "col-md-3 secondary" ng-show = "snippet.selector != ''"> 
                                            <div class = "label1"> Selector: </div>
                                            <div class = "customized"> [[snippet.selector]] </div>
                                        </div>
                                        <div class = "col-md-3 secondary" ng-show = "snippet.url != ''"> 
                                            <div class = "label1"> URL: </div>
                                            <div class = "customized"> [[snippet.url]] </div>
                                        </div>
                                        <div class = "col-md-3 secondary" ng-show = "snippet.text != ''"> 
                                            <div class = "label1"> Text: </div>
                                            <div class = "customized"> [[snippet.text]] </div>
                                        </div>
                                    </div>
                                    <div class = "col-md-1 remove" ng-click = "removeSnippetRow($index)"> Remove </div>
                                    <div class = "col-md-2"></div> 
                                </div>
                    </div> 

    <!--                 THIS ADDS TO THE SNIPPET -->
                    <div class = "row">
                        <div class = "col-md-2"></div>

                        <div class = "col-md-2">
                        <select name="cars" class = "input selectpicker width" ng-model = "snippetItem.action" ng-change = "selectedChanged()">
                          <option value="navigate to url">navigate to</option>
                          <option value="exists">check if exists</option>
                          <option value="does not exist">check if doesn't exist</option>
                          <option value="click">click on</option>
                          <option value="enter text">enter text in box</option>
                        </select>
                        </div>

                        <div ng-show = "snippetItem.action != 'navigate to url' && snippetItem.action != 'enter text' ">
                            <div class = "col-md-4 center"> 
                                <input class = "input form-control" type="text" placeholder = "enter selector" ng-model="snippetItem.selector" />
                            </div> 
                        </div>
                        <div ng-show = "snippetItem.action == 'enter text' ">
                            <div class = "col-md-2 center"> 
                                <input class = "input form-control" type="text" placeholder = "enter selector" ng-model="snippetItem.selector" />
                            </div> 
                            <div class = "col-md-2 center"> 
                                <input class = "input form-control" type="text" placeholder = "enter text" ng-model="snippetItem.text" />
                            </div>
                        </div>
                        <div ng-show = "snippetItem.action == 'navigate to url'">
                            <div class = "col-md-4 center"> 
                                <input class = "input form-control" type="text" placeholder = "enter url" ng-model="snippetItem.url" />
                            </div>
                        </div>
                        <div class = "col-md-2"> <div class = "addButton2" ng-click="addToSnippet(snippetItem)"> Add </div> </div>
                    </div>


                    <div class = "row">
                        <div class = "col-md-4"></div>
                        <div class = "col-md-4 button" ng-click = "addToSnippetList()"> add to snippets! </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- BUTTON STUFF HERE -->
        <div class = "row">
            <div class = "col-md-2"></div>
            <div class = "col-md-2" ng-click="addAnotherRow()"> 
                <div class = "button"> add another row </div> 
            </div>
            <div class = "col-md-2" ng-click="generate(); changeName()"> 
                <div class = "button"> [[generateMessage]] </div> 
            </div>
            <div class = "col-md-2" ng-click="clear()"> 
                <div class = "button"> start over </div> 
            </div>
            <div class = "col-md-2" ng-click="savedRows()"> 
                <div class = "button"> [[snippetMessage]] </div> 
            </div>
        </div>

        <div ng-show = "showScript"> 
            <div class = "row">
                <div class = "col-md-2"></div>
                <div class = "col-md-8 scroll"> <pre>[[generatedScript]]</pre> </div>
            </div>
        </div> 

        <div class = "row" ng-show = "showScript">
            <div class = "col-md-4"></div>
            <a download="[[randomName]]" ng-href="[[url]]" class = "col-md-4 button2"> download this script </a>
        </div>

    </body>
</html>